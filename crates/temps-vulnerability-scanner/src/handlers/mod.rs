pub mod scans_handler;

use axum::Router;
use std::sync::Arc;

pub use scans_handler::ScansApiDoc;

#[derive(Clone)]
pub struct VulnerabilityScannerAppState {
    pub scan_service: Arc<crate::service::VulnerabilityScanService>,
    pub audit_service: Arc<dyn temps_core::AuditLogger>,
}

pub async fn create_vulnerability_scanner_app_state(
    scan_service: Arc<crate::service::VulnerabilityScanService>,
    audit_service: Arc<dyn temps_core::AuditLogger>,
) -> VulnerabilityScannerAppState {
    VulnerabilityScannerAppState {
        scan_service,
        audit_service,
    }
}

pub fn configure_routes() -> Router<Arc<VulnerabilityScannerAppState>> {
    Router::new().merge(scans_handler::configure_routes())
}
