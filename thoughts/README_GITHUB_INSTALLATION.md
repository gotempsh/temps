# GitHub App Installation & Setup - Frontend Documentation

This directory contains comprehensive documentation about the GitHub app installation flow in the Temps frontend.

## Documentation Files

### 1. **GITHUB_INSTALLATION_QUICK_START.md** - START HERE
Quick reference guide with:
- Main files and line numbers
- Installation flow diagrams
- Where installation status is shown
- Common issues and solutions
- Testing checklist

**Best for:** Quick answers, finding specific code locations, troubleshooting

---

### 2. **github_installation_frontend_map.md** - TECHNICAL DEEP DIVE
Complete technical breakdown with:
- Detailed file descriptions
- Code flow explanations
- GitHub OAuth flow description
- Query parameter handling
- Component hierarchy
- API endpoints
- React hooks and patterns

**Best for:** Understanding the full architecture, making major changes, comprehensive knowledge

---

### 3. **github_installation_flow_diagram.txt** - VISUAL REFERENCE
ASCII art diagrams showing:
- Entry points and navigation flow
- Multi-step wizard breakdown
- GitHub app creation process
- Installation polling mechanism
- Installation ID tracking journey
- Component display locations
- Data flow through the system

**Best for:** Understanding the flow visually, presentations, following user journey

---

## Quick Navigation

### Find the Code
- **Installation status display** → `GitProviderDetail.tsx` (lines 401-432)
- **Create GitHub App** → `GitProviderFlow.tsx` (lines 267-374)
- **Installation detection** → `GitProviderFlow.tsx` (lines 153-191)
- **Show installation_id** → `ConnectionsTable.tsx` (lines 161-169)
- **Install button handler** → `GitProviderDetail.tsx` (lines 131-147)

### Understand the Flow
1. Read: QUICK_START.md "User Installs GitHub App" section
2. View: github_installation_flow_diagram.txt "ENTRY POINTS" section
3. Deep dive: github_installation_frontend_map.md "GitHub Installation Flow - Current Architecture"

### Solve a Problem
1. Check: QUICK_START.md "Common Issues & Solutions"
2. Verify: github_installation_flow_diagram.txt "CURRENT GAPS"
3. Research: github_installation_frontend_map.md relevant section

### Modify the Code
1. Find the component: QUICK_START.md "Files You Might Need to Modify"
2. Get the code location: github_installation_frontend_map.md "File Locations Summary"
3. Understand the impact: github_installation_flow_diagram.txt relevant section

---

## Key Concepts

### Installation ID
- Generated by GitHub when app is installed
- Stored in `ConnectionResponse.installation_id`
- Displayed in ConnectionsTable as monospace text
- Example: `"12345678"`

### Polling Mechanism
- Polls every 2 seconds while `isPollingInstallations = true`
- Detects when new GitHub App provider is created
- Timeout after 60 seconds
- Uses `refetchInterval` from React Query

### GitHub App Setup Card
- Shows when provider is GitHub App type
- AND no connections exist (no installations yet)
- Located in GitProviderDetail.tsx lines 401-432
- Contains instructions and install button

### Installation Flow
1. User creates GitHub App at GitHub settings
2. Frontend posts manifest to `https://github.com/settings/apps/new`
3. Backend receives callback at `/api/webhook/git/github/callback`
4. Backend stores installation_id in database
5. Frontend polling detects new provider
6. Shows success message and displays installation in connections table

---

## File Locations Summary

| What | Where | Lines |
|------|-------|-------|
| Installation handler | GitProviderDetail.tsx | 131-147 |
| Setup instructions card | GitProviderDetail.tsx | 401-432 |
| Install button (header) | GitProviderDetail.tsx | 287-295 |
| Install button (connections) | GitProviderDetail.tsx | 474-484 |
| Install button (empty state) | GitProviderDetail.tsx | 514-522 |
| Polling setup | GitProviderFlow.tsx | 98-101 |
| GitHub app creation | GitProviderFlow.tsx | 267-374 |
| Installation detection | GitProviderFlow.tsx | 153-191 |
| Polling timeout | GitProviderFlow.tsx | 135-151 |
| Installation ID display | ConnectionsTable.tsx | 161-169 |
| Install button (list) | GitSources.tsx | 90-102 |

---

## Important Files Not to Miss

- **Types:** `/web/src/api/client/types.gen.ts` - `ConnectionResponse` with `installation_id` field
- **Routing:** `/web/src/App.tsx` - Page routing setup
- **Hooks:** Various custom hooks like `useFeedback()`, `usePageTitle()`, `useKeyboardShortcut()`
- **Icons:** `lucide-react` for UI icons

---

## Common Tasks

### Adding Installation Success Page
See: QUICK_START.md "Add installation success page"
1. Create: `/web/src/pages/GitHubInstallationComplete.tsx`
2. Add route in App.tsx
3. Update GitProviderFlow.tsx onSuccess

### Customizing Installation Instructions
See: QUICK_START.md "Customize installation instructions"
- Edit: `GitProviderDetail.tsx` lines 401-432
- Modify the GitHub App Setup Card content

### Improving Installation Detection
See: github_installation_flow_diagram.txt "POLLING MECHANISM - DETAILED FLOW"
- Current: Polling every 2 seconds
- Could implement: WebSocket or Server-Sent Events (SSE)

### Adding Installation Status Badge
See: QUICK_START.md "Show installation status on list page"
- Edit: `GitSources.tsx`
- Add badge to show "Installed" vs "Created" status

---

## Related Code Areas

- **Authentication:** `temps-auth` crate
- **Git Providers API:** Backend Rust code
- **Components:** `/web/src/components/git-*`
- **Pages:** `/web/src/pages/*`
- **Hooks:** `/web/src/hooks/`
- **Utils:** `/web/src/lib/`

---

## Additional Resources

### Tools Used
- React 18+ with TypeScript
- React Router for navigation
- React Query (TanStack Query) for data fetching
- shadcn/ui for components
- Lucide icons for icons
- Sonner for toast notifications
- Zod for form validation
- React Hook Form for form handling

### GitHub App Documentation
- [GitHub App Manifest](https://docs.github.com/en/apps/creating-github-apps/creating-github-apps-using-the-web-flow)
- [GitHub Installation Endpoint](https://docs.github.com/en/rest/apps/installations)
- [GitHub OAuth Flow](https://docs.github.com/en/apps/oauth-apps/building-oauth-apps/authorizing-oauth-apps)

---

## Notes

- No dedicated installation complete page currently exists
- All installation detection happens via polling (not webhook)
- GitHub callback is handled by backend, not frontend
- Setup URL field in GitHub app manifest is not currently used
- Installation status displays in multiple places for user guidance
